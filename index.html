<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Scoring Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-dark': '#4B4BC8'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen">
    <div class="container mx-auto px-4 py-6 max-w-7xl">
        <!-- Header -->
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
            <div>
                <h1 class="text-3xl font-bold text-primary dark:text-primary-light">Player Scoring Tracker</h1>
                <p class="text-gray-600 dark:text-gray-400 mt-1">Track wins, places, highest odds, and bonus points</p>
            </div>
            <div class="flex items-center gap-4">
                <label class="flex items-center cursor-pointer">
                    <input type="checkbox" id="adminMode" class="sr-only">
                    <div class="relative">
                        <div class="block bg-gray-300 dark:bg-gray-600 w-14 h-8 rounded-full"></div>
                        <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition transform"></div>
                    </div>
                    <span class="ml-3 text-sm font-medium">Admin Mode</span>
                </label>
                <button onclick="addRound()" id="addRoundBtn" class="bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    Add Round
                </button>
            </div>
        </div>

        <!-- Scoring Rules -->
        <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg mb-6">
            <h3 class="font-semibold text-sm mb-2">Scoring Rules:</h3>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm">
                <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Win: 3 points</div>
                <div class="flex items-center"><span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>Place: 1 point</div>
                <div class="flex items-center"><span class="w-2 h-2 bg-purple-500 rounded-full mr-2"></span>Highest Odds: 5 points</div>
            </div>
        </div>

        <!-- Current Standings -->
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 p-4 rounded-lg">
                <div class="text-2xl font-bold text-blue-600 dark:text-blue-400" id="eggmanTotal">0</div>
                <div class="text-sm text-blue-600 dark:text-blue-400">Eggman</div>
            </div>
            <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/30 p-4 rounded-lg">
                <div class="text-2xl font-bold text-green-600 dark:text-green-400" id="georgeTotal">0</div>
                <div class="text-sm text-green-600 dark:text-green-400">George</div>
            </div>
            <div class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/30 p-4 rounded-lg">
                <div class="text-2xl font-bold text-purple-600 dark:text-purple-400" id="chrisTotal">0</div>
                <div class="text-sm text-purple-600 dark:text-purple-400">Chris</div>
            </div>
        </div>

        <!-- Score Table -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-6">
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="bg-gray-50 dark:bg-gray-700">
                        <tr>
                            <th class="px-3 py-3 text-left font-medium text-gray-600 dark:text-gray-300">Round</th>
                            <th colspan="5" class="px-3 py-3 text-center font-medium text-gray-600 dark:text-gray-300 border-l border-gray-200 dark:border-gray-600">Eggman</th>
                            <th colspan="5" class="px-3 py-3 text-center font-medium text-gray-600 dark:text-gray-300 border-l border-gray-200 dark:border-gray-600">George</th>
                            <th colspan="5" class="px-3 py-3 text-center font-medium text-gray-600 dark:text-gray-300 border-l border-gray-200 dark:border-gray-600">Chris</th>
                        </tr>
                        <tr class="bg-gray-100 dark:bg-gray-600">
                            <th class="px-3 py-2"></th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Win</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Place</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">H.Odds</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Bonus</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Total</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400 border-l border-gray-200 dark:border-gray-500">Win</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Place</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">H.Odds</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Bonus</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Total</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400 border-l border-gray-200 dark:border-gray-500">Win</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Place</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">H.Odds</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Bonus</th>
                            <th class="px-2 py-2 text-xs text-gray-500 dark:text-gray-400">Total</th>
                        </tr>
                    </thead>
                    <tbody id="scoreTableBody">
                        <!-- Rows will be added dynamically -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Charts -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
                <h3 class="text-lg font-semibold mb-4">Cumulative Score Trend</h3>
                <canvas id="trendChart" width="400" height="200"></canvas>
            </div>
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
                <h3 class="text-lg font-semibold mb-4">Score Breakdown</h3>
                <canvas id="breakdownChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let rounds = [];
        let isAdminMode = false;
        let trendChart, breakdownChart;

        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            updateCharts();
        });

        // Admin mode toggle
        const adminToggle = document.getElementById('adminMode');
        adminToggle.addEventListener('change', function() {
            isAdminMode = this.checked;
            document.getElementById('addRoundBtn').disabled = !isAdminMode;
            
            // Update toggle appearance
            const dot = this.parentElement.querySelector('.dot');
            const bg = this.parentElement.querySelector('.block');
            if (isAdminMode) {
                dot.style.transform = 'translateX(24px)';
                bg.style.backgroundColor = '#5D5CDE';
            } else {
                dot.style.transform = 'translateX(0)';
                bg.style.backgroundColor = '';
            }
            
            updateTable();
        });

        function addRound() {
            if (!isAdminMode) return;
            
            const roundNumber = rounds.length + 1;
            const newRound = {
                round: roundNumber,
                eggman: { win: 0, place: 0, highestOdds: 0, bonus: 0 },
                george: { win: 0, place: 0, highestOdds: 0, bonus: 0 },
                chris: { win: 0, place: 0, highestOdds: 0, bonus: 0 }
            };
            
            rounds.push(newRound);
            updateTable();
            updateTotals();
            updateCharts();
        }

        function calculateRoundTotal(player) {
            return (player.win * 3) + (player.place * 1) + (player.highestOdds * 5) + player.bonus;
        }

        function updateRoundData(roundIndex, player, field, value) {
            if (!isAdminMode) return;
            
            rounds[roundIndex][player][field] = parseInt(value) || 0;
            updateTotals();
            updateCharts();
        }

        function updateTable() {
            const tbody = document.getElementById('scoreTableBody');
            tbody.innerHTML = '';
            
            rounds.forEach((round, index) => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700';
                
                const eggmanTotal = calculateRoundTotal(round.eggman);
                const georgeTotal = calculateRoundTotal(round.george);
                const chrisTotal = calculateRoundTotal(round.chris);
                
                row.innerHTML = `
                    <td class="px-3 py-3 font-medium">${round.round}</td>
                    ${createPlayerCells('eggman', round.eggman, index, eggmanTotal)}
                    ${createPlayerCells('george', round.george, index, georgeTotal)}
                    ${createPlayerCells('chris', round.chris, index, chrisTotal)}
                `;
                
                tbody.appendChild(row);
            });
        }

        function createPlayerCells(playerName, playerData, roundIndex, total) {
            const borderClass = playerName === 'eggman' ? '' : 'border-l border-gray-200 dark:border-gray-600';
            const readonly = isAdminMode ? '' : 'readonly';
            const inputClass = `w-12 px-1 py-1 text-center text-base border rounded ${isAdminMode ? 'bg-white dark:bg-gray-700' : 'bg-gray-100 dark:bg-gray-600'} border-gray-300 dark:border-gray-500 focus:border-primary focus:ring-1 focus:ring-primary outline-none`;
            
            return `
                <td class="px-2 py-2 ${borderClass}">
                    <input type="number" value="${playerData.win}" min="0" max="99" ${readonly}
                           class="${inputClass}"
                           onchange="updateRoundData(${roundIndex}, '${playerName}', 'win', this.value)">
                </td>
                <td class="px-2 py-2">
                    <input type="number" value="${playerData.place}" min="0" max="99" ${readonly}
                           class="${inputClass}"
                           onchange="updateRoundData(${roundIndex}, '${playerName}', 'place', this.value)">
                </td>
                <td class="px-2 py-2">
                    <input type="number" value="${playerData.highestOdds}" min="0" max="99" ${readonly}
                           class="${inputClass}"
                           onchange="updateRoundData(${roundIndex}, '${playerName}', 'highestOdds', this.value)">
                </td>
                <td class="px-2 py-2">
                    <input type="number" value="${playerData.bonus}" min="-99" max="99" ${readonly}
                           class="${inputClass}"
                           onchange="updateRoundData(${roundIndex}, '${playerName}', 'bonus', this.value)">
                </td>
                <td class="px-2 py-2 font-medium">${total}</td>
            `;
        }

        function updateTotals() {
            let eggmanTotal = 0, georgeTotal = 0, chrisTotal = 0;
            
            rounds.forEach(round => {
                eggmanTotal += calculateRoundTotal(round.eggman);
                georgeTotal += calculateRoundTotal(round.george);
                chrisTotal += calculateRoundTotal(round.chris);
            });
            
            document.getElementById('eggmanTotal').textContent = eggmanTotal;
            document.getElementById('georgeTotal').textContent = georgeTotal;
            document.getElementById('chrisTotal').textContent = chrisTotal;
        }

        function initCharts() {
            const isDark = document.documentElement.classList.contains('dark');
            const textColor = isDark ? '#D1D5DB' : '#374151';
            const gridColor = isDark ? '#374151' : '#E5E7EB';
            
            // Trend Chart
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        {
                            label: 'Eggman',
                            data: [],
                            borderColor: '#3B82F6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'George',
                            data: [],
                            borderColor: '#10B981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'Chris',
                            data: [],
                            borderColor: '#8B5CF6',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: textColor },
                            grid: { color: gridColor }
                        },
                        x: {
                            ticks: { color: textColor },
                            grid: { color: gridColor }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: textColor }
                        }
                    }
                }
            });

            // Breakdown Chart
            const breakdownCtx = document.getElementById('breakdownChart').getContext('2d');
            breakdownChart = new Chart(breakdownCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Eggman', 'George', 'Chris'],
                    datasets: [{
                        data: [0, 0, 0],
                        backgroundColor: ['#3B82F6', '#10B981', '#8B5CF6'],
                        borderWidth: 2,
                        borderColor: isDark ? '#1F2937' : '#FFFFFF'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: textColor }
                        }
                    }
                }
            });
        }

        function updateCharts() {
            if (!trendChart || !breakdownChart) return;
            
            const isDark = document.documentElement.classList.contains('dark');
            const textColor = isDark ? '#D1D5DB' : '#374151';
            const gridColor = isDark ? '#374151' : '#E5E7EB';
            
            // Update colors for dark mode
            trendChart.options.scales.y.ticks.color = textColor;
            trendChart.options.scales.x.ticks.color = textColor;
            trendChart.options.scales.y.grid.color = gridColor;
            trendChart.options.scales.x.grid.color = gridColor;
            trendChart.options.plugins.legend.labels.color = textColor;
            
            breakdownChart.options.plugins.legend.labels.color = textColor;
            breakdownChart.data.datasets[0].borderColor = isDark ? '#1F2937' : '#FFFFFF';
            
            // Update trend data
            const labels = rounds.map((_, index) => `Round ${index + 1}`);
            let eggmanCumulative = 0, georgeCumulative = 0, chrisCumulative = 0;
            
            const eggmanData = rounds.map(round => {
                eggmanCumulative += calculateRoundTotal(round.eggman);
                return eggmanCumulative;
            });
            
            const georgeData = rounds.map(round => {
                georgeCumulative += calculateRoundTotal(round.george);
                return georgeCumulative;
            });
            
            const chrisData = rounds.map(round => {
                chrisCumulative += calculateRoundTotal(round.chris);
                return chrisCumulative;
            });
            
            trendChart.data.labels = labels;
            trendChart.data.datasets[0].data = eggmanData;
            trendChart.data.datasets[1].data = georgeData;
            trendChart.data.datasets[2].data = chrisData;
            
            // Update breakdown data
            const finalTotals = [
                eggmanCumulative,
                georgeCumulative,
                chrisCumulative
            ];
            breakdownChart.data.datasets[0].data = finalTotals;
            
            trendChart.update();
            breakdownChart.update();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            // Add a sample round for demonstration
            addRound();
        });
    </script>
</body>
</html>